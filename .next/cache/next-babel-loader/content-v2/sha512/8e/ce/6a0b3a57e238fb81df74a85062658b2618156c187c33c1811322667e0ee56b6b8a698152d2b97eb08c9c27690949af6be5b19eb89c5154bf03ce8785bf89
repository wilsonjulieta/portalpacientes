{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useContext, useEffect, useState } from \"react\"; // @material-ui/core components\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport InputLabel from \"@material-ui/core/InputLabel\"; // layout for this page\n\nimport Admin from \"layouts/Admin.js\"; // core components\n\nimport GridItem from \"components/Grid/GridItem.js\";\nimport GridContainer from \"components/Grid/GridContainer.js\";\nimport CustomInput from \"components/CustomInput/CustomInput.js\";\nimport Button from \"components/CustomButtons/Button.js\";\nimport Card from \"components/Card/Card.js\";\nimport CardHeader from \"components/Card/CardHeader.js\";\nimport CardAvatar from \"components/Card/CardAvatar.js\";\nimport CardBody from \"components/Card/CardBody.js\";\nimport CardFooter from \"components/Card/CardFooter.js\";\nimport avatar from \"assets/img/faces/marc.jpg\";\nimport Login from \"../../layouts/Login\";\nimport { FormControl, FormGroup, MenuItem, NativeSelect, Select, TextField } from \"@material-ui/core\";\nimport styles from \"assets/jss/nextjs-material-dashboard/layouts/loginStyle.js\";\nimport { ThemeContext } from \"../../context/ThemeContextProvider\";\nimport { useRouter } from \"next/router\";\nimport THEMES from \"../../constants/THEMES\";\nimport { logIn } from \"../../services/userAuth.js\";\nimport { UserContext } from \"../../context/UserContextProvider\";\nimport useTheme from \"../../hooks/useTheme\";\nimport CustomPasswordInput from \"../../components/CustomInput/CustomPasswordInput\";\nimport { setCookie } from \"nookies\";\nimport { hideLoad, showLoad } from \"../../utils/loading\";\nexport async function getServerSideProps(context) {\n  const {\n    consultorioId\n  } = context.query;\n  return {\n    props: {\n      consultorioId\n    }\n  };\n}\n\nfunction LoginView({\n  consultorioId\n}) {\n  const router = useRouter();\n  const path = \"Inicio\";\n  const classes = useTheme(styles);\n  const {\n    0: errorMsg,\n    1: setErrorMsg\n  } = useState(\"\");\n  const {\n    setUser\n  } = useContext(UserContext);\n\n  const handleSubmit = async event => {\n    event.preventDefault();\n    const formData = new FormData(event.target);\n    const tipoDoc = formData.get(\"tipodoc\");\n    const username = formData.get(\"username\");\n    const password = formData.get(\"password\");\n    showLoad(path);\n    let loginResponse = {};\n\n    try {\n      loginResponse = await logIn(tipoDoc, username, password, consultorioId);\n    } catch (error) {} finally {}\n\n    console.log(loginResponse); // loginResponse = {message: \"Sus datos estÃ¡n cargados pero no se encuentra registrado. Ingrese a \\\"registrarse\\\".\"}\n\n    if (loginResponse.loggedIn) {\n      sessionStorage.setItem(\"id\", loginResponse.data.id);\n      sessionStorage.setItem(\"token\", loginResponse.token);\n      setCookie(null, 'id', loginResponse.data.id, {\n        maxAge: 50 * 365 * 24 * 60 * 60,\n        path: '/'\n      });\n      setCookie(null, 'token', loginResponse.token, {\n        maxAge: 24 * 60 * 60,\n        path: '/'\n      });\n      setUser(_objectSpread(_objectSpread({}, loginResponse.data), {}, {\n        consultorioId\n      }));\n      router.push(\"/admin/\" + consultorioId + \"/dashboard\");\n      return true;\n    } else {\n      sessionStorage.clear();\n      hideLoad(path);\n      setErrorMsg(loginResponse.message);\n      return false;\n    }\n  };\n\n  const handleRegisterRedirect = () => {\n    const currentPath = router.asPath; // get the current URL path\n\n    router.push(currentPath + \"/register\");\n  };\n\n  return /*#__PURE__*/_jsx(\"form\", {\n    method: \"post\",\n    action: \"/admin/dashboard\",\n    onSubmit: handleSubmit,\n    autoComplete: \"on\",\n    children: /*#__PURE__*/_jsx(GridContainer, {\n      style: {\n        width: \"100%\",\n        height: \"80vh\",\n        alignItems: \"center\"\n      },\n      justify: \"center\",\n      children: /*#__PURE__*/_jsx(GridItem, {\n        xs: 12,\n        sm: 10,\n        md: 7,\n        children: /*#__PURE__*/_jsxs(Card, {\n          children: [/*#__PURE__*/_jsxs(CardHeader, {\n            color: \"primary\",\n            children: [/*#__PURE__*/_jsx(\"h4\", {\n              className: classes.cardTitleWhite,\n              children: \"Bienvenido\"\n            }), /*#__PURE__*/_jsx(\"p\", {\n              className: classes.cardCategoryWhite,\n              children: \"Complete sus datos de ingreso\"\n            })]\n          }), /*#__PURE__*/_jsx(CardBody, {\n            children: /*#__PURE__*/_jsxs(GridContainer, {\n              children: [/*#__PURE__*/_jsx(GridItem, {\n                xs: 12,\n                sm: 12,\n                md: 12,\n                children: /*#__PURE__*/_jsxs(FormControl, {\n                  fullWidth: true,\n                  children: [/*#__PURE__*/_jsx(InputLabel, {\n                    className: classes.label,\n                    variant: \"standard\",\n                    htmlFor: \"uncontrolled-native\",\n                    children: \"Tipo de Documento\"\n                  }), /*#__PURE__*/_jsxs(Select, {\n                    className: classes.select,\n                    classes: {\n                      root: classes.selectRoot\n                    },\n                    defaultValue: 1,\n                    inputProps: {\n                      name: 'tipodoc',\n                      id: 'uncontrolled-native',\n                      required: true,\n                      onChange: () => setErrorMsg(false)\n                    },\n                    children: [/*#__PURE__*/_jsx(MenuItem, {\n                      value: 1,\n                      selected: true,\n                      children: \"DNI\"\n                    }), /*#__PURE__*/_jsx(MenuItem, {\n                      value: 2,\n                      children: \"CI\"\n                    }), /*#__PURE__*/_jsx(MenuItem, {\n                      value: 3,\n                      children: \"Pasaporte\"\n                    })]\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(GridItem, {\n                xs: 12,\n                sm: 12,\n                md: 12,\n                children: /*#__PURE__*/_jsx(CustomInput, {\n                  labelText: \"Nro. de Documento\",\n                  id: \"username\",\n                  formControlProps: {\n                    fullWidth: true\n                  },\n                  inputProps: {\n                    name: 'username',\n                    id: \"username\",\n                    type: \"number\",\n                    required: true,\n                    autoComplete: \"username\",\n                    onChange: () => setErrorMsg(false)\n                  }\n                })\n              }), /*#__PURE__*/_jsx(GridItem, {\n                xs: 12,\n                sm: 12,\n                md: 12,\n                children: /*#__PURE__*/_jsx(CustomPasswordInput, {\n                  labelText: \"Contrase\\xF1a\",\n                  inputName: \"password\",\n                  handleChangeHook: () => setErrorMsg(false)\n                })\n              }), /*#__PURE__*/_jsx(GridItem, {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  style: {\n                    color: errorMsg ? \"red\" : \"transparent\",\n                    margin: \"0\",\n                    transition: \"all 0.6s\",\n                    userSelect: \"none\"\n                  },\n                  children: errorMsg ? errorMsg : \"Sus datos estan cargados pero no se encuentra registrado. Ingrese a \\\"registrarse\\\".\"\n                })\n              })]\n            })\n          }), /*#__PURE__*/_jsxs(CardFooter, {\n            style: {\n              paddingTop: \"0\",\n              flexWrap: \"wrap\",\n              rowGap: \"10px\",\n              justifyContent: \"center\",\n              paddingInline: \"18px\"\n            },\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              style: {\n                flex: \"1 0 33.33%\",\n                textAlign: \"left\"\n              },\n              className: \"botonLoginRegistro\",\n              children: /*#__PURE__*/_jsx(Button, {\n                onClick: handleRegisterRedirect,\n                type: \"button\",\n                color: \"primaryOutlined\",\n                style: {\n                  padding: \"15px 6px\"\n                },\n                children: \"Registrarse\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                flex: \"1 0 33.33%\",\n                textAlign: \"center\"\n              },\n              className: \"botonLoginIngreso\",\n              children: /*#__PURE__*/_jsx(Button, {\n                type: \"submit\",\n                color: \"primary\",\n                style: {\n                  fontSize: \"1.35em\"\n                },\n                children: \"Ingresar\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                flex: \"1 0 33.33%\",\n                textAlign: \"right\"\n              },\n              className: \"botonLoginOlvido\",\n              children: /*#__PURE__*/_jsx(Button, {\n                type: \"button\",\n                color: \"secondarySimple\",\n                style: {\n                  padding: \"15px 6px\"\n                },\n                children: \"Olvid\\xE9 mi contrase\\xF1a\"\n              })\n            })]\n          })]\n        })\n      })\n    })\n  });\n}\n\nLoginView.layout = Login;\nexport default LoginView;","map":null,"metadata":{},"sourceType":"module"}