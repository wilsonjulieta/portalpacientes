{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/*!\r\n\r\n=========================================================\r\n* NextJS Material Dashboard v1.1.0 based on Material Dashboard React v1.9.0\r\n=========================================================\r\n\r\n* Product Page: https://www.creative-tim.com/product/nextjs-material-dashboard\r\n* Copyright 2021 Creative Tim (https://www.creative-tim.com)\r\n* Licensed under MIT (https://github.com/creativetimofficial/nextjs-material-dashboard/blob/master/LICENSE.md)\r\n\r\n* Coded by Creative Tim\r\n\r\n=========================================================\r\n\r\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\n*/\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"next/app\";\nimport Head from \"next/head\";\nimport Router from \"next/router\";\nimport PageChange from \"components/PageChange/PageChange.js\";\nimport \"assets/css/nextjs-material-dashboard.css?v=1.1.0\";\nimport ThemeContextProvider from \"../context/ThemeContextProvider\";\nimport THEMES from \"../constants/THEMES\";\nimport UserContextProvider from \"../context/UserContextProvider\";\nimport nookies from 'nookies';\nimport { hideLoad, showLoad } from \"../utils/loading\";\nimport { getPatient } from \"../services/userAuth\";\nimport GLOBAL_GET_TOKEN from \"../utils/token\";\nimport MessageDialog from \"../components/Dialogs/MessageDialog\";\nimport MessageDialogContextProvider from \"../context/MessageDialogContextProvider\";\nimport '../styles/globals.css';\nRouter.events.on(\"routeChangeStart\", url => {\n  showLoad(url);\n});\nRouter.events.on(\"routeChangeComplete\", () => {\n  hideLoad();\n});\nRouter.events.on(\"routeChangeError\", () => {\n  hideLoad();\n});\nexport default class MyApp extends App {\n  componentDidMount() {\n    let comment = document.createComment(`\n\n=========================================================\n* * NextJS Material Dashboard v1.1.0 based on Material Dashboard React v1.9.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/nextjs-material-dashboard\n* Copyright 2021 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/nextjs-material-dashboard/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n`);\n    document.insertBefore(comment, document.documentElement);\n  } // GetInitialProps corre tanto en server al principio, como en cliente al cambiar de pagina. \n  // La logica requerida solo es requerida al correr del server al principio, por tanto no valido que corra desde el cliente.\n\n\n  static async getInitialProps({\n    Component,\n    router,\n    ctx\n  }) {\n    var _cookies$loginTries;\n\n    let pageProps = {};\n    let {\n      consultorioId\n    } = router.query;\n    const cookies = nookies.get(ctx); // Setear o pedir id de consultorio\n\n    if (consultorioId) {\n      // Set\n      nookies.set(ctx, 'consultorioId', consultorioId, {\n        maxAge: 50 * 365 * 24 * 60 * 60,\n        path: '/'\n      });\n    } else {\n      consultorioId = cookies.consultorioId;\n    } // Redirigir de admin si el usuario no esta logueado\n\n\n    if (cookies.id === undefined && router.asPath.includes(\"admin\") && true) {\n      ctx.res.writeHead(302, {\n        Location: '/login/' + consultorioId,\n        'Content-Type': 'text/html; charset=utf-8'\n      });\n      ctx.res.end();\n    } // Setear si existe, el usuario que ya esta logueado\n\n\n    let initUser;\n\n    if (cookies.id !== undefined && Number((_cookies$loginTries = cookies.loginTries) !== null && _cookies$loginTries !== void 0 ? _cookies$loginTries : 0) <= 2 && true && !router.asPath.includes(\"server-error\")) {\n      try {\n        const {\n          id,\n          token\n        } = {\n          id: cookies.id,\n          token: await GLOBAL_GET_TOKEN(ctx)\n        };\n        console.log({\n          id,\n          consultorioId,\n          token\n        });\n        let patientResponse = await getPatient(id, consultorioId, token);\n        console.log({\n          patientResponse\n        });\n\n        if (!patientResponse.success) {\n          throw Error(\"\");\n        }\n\n        initUser = patientResponse.data;\n\n        if (!router.asPath.includes(\"admin\") && !router.asPath.includes(\"testing\")) {\n          ctx.res.writeHead(302, {\n            Location: '/admin/' + consultorioId + \"/dashboard\",\n            'Content-Type': 'text/html; charset=utf-8'\n          });\n          ctx.res.end(); // ctx.res.finished = true;\n        }\n      } catch (error) {\n        var _cookies$loginTries2;\n\n        nookies.set(ctx, 'loginTries', Number((_cookies$loginTries2 = cookies.loginTries) !== null && _cookies$loginTries2 !== void 0 ? _cookies$loginTries2 : 0) + 1, {\n          maxAge: 60,\n          path: '/'\n        });\n\n        if (Number(cookies.loginTries) === 2) {\n          nookies.destroy(ctx, \"id\", {\n            path: \"/\"\n          });\n          nookies.destroy(ctx, \"dni\", {\n            path: \"/\"\n          });\n          nookies.destroy(ctx, \"loginTries\", {\n            path: \"/\"\n          });\n        }\n\n        ctx.res.writeHead(302, {\n          Location: '/login/' + consultorioId + \"/server-error\",\n          'Content-Type': 'text/html; charset=utf-8'\n        });\n        ctx.res.end(); // ctx.res.finished = true;\n      }\n    }\n\n    if (Component.getInitialProps) {\n      pageProps = await Component.getInitialProps(ctx);\n    }\n\n    return {\n      pageProps,\n      consultorioId,\n      initUser\n    };\n  }\n\n  render() {\n    const {\n      Component,\n      pageProps,\n      consultorioId,\n      initUser\n    } = this.props;\n\n    const Layout = Component.layout || (({\n      children\n    }) => /*#__PURE__*/_jsx(_Fragment, {\n      children: children\n    }));\n\n    return /*#__PURE__*/_jsx(ThemeContextProvider, {\n      theme: THEMES[consultorioId - 1],\n      children: /*#__PURE__*/_jsx(UserContextProvider, {\n        initUser: _objectSpread(_objectSpread({}, initUser), {}, {\n          consultorioId\n        }),\n        children: /*#__PURE__*/_jsxs(React.Fragment, {\n          children: [/*#__PURE__*/_jsxs(Head, {\n            children: [/*#__PURE__*/_jsx(\"meta\", {\n              name: \"viewport\",\n              content: \"width=device-width, initial-scale=1, shrink-to-fit=no\"\n            }), /*#__PURE__*/_jsx(\"title\", {\n              children: \"NextJS Material Dashboard by Creative Tim\"\n            }), /*#__PURE__*/_jsx(\"script\", {\n              src: \"https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE\"\n            })]\n          }), /*#__PURE__*/_jsx(Layout, {\n            children: /*#__PURE__*/_jsx(MessageDialogContextProvider, {\n              children: /*#__PURE__*/_jsx(Component, _objectSpread({}, pageProps))\n            })\n          })]\n        })\n      })\n    });\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}