{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\DATOS\\\\THISYS\\\\SISTEMA\\\\PORTAL WEB\\\\Proyecto-Salud\\\\pages\\\\_app.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n/*!\r\n\r\n=========================================================\r\n* NextJS Material Dashboard v1.1.0 based on Material Dashboard React v1.9.0\r\n=========================================================\r\n\r\n* Product Page: https://www.creative-tim.com/product/nextjs-material-dashboard\r\n* Copyright 2021 Creative Tim (https://www.creative-tim.com)\r\n* Licensed under MIT (https://github.com/creativetimofficial/nextjs-material-dashboard/blob/master/LICENSE.md)\r\n\r\n* Coded by Creative Tim\r\n\r\n=========================================================\r\n\r\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\n*/\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"next/app\";\nimport Head from \"next/head\";\nimport Router from \"next/router\";\nimport PageChange from \"components/PageChange/PageChange.js\";\nimport \"assets/css/nextjs-material-dashboard.css?v=1.1.0\";\nimport ThemeContextProvider from \"../context/ThemeContextProvider\";\nimport THEMES from \"../constants/THEMES\";\nimport UserContextProvider from \"../context/UserContextProvider\";\nimport nookies from 'nookies';\nimport { hideLoad, showLoad } from \"../utils/loading\";\nimport { getPatient } from \"../services/userAuth\";\nimport GLOBAL_GET_TOKEN from \"../utils/token\";\nimport MessageDialog from \"../components/Dialogs/MessageDialog\";\nimport MessageDialogContextProvider from \"../context/MessageDialogContextProvider\";\nimport '../styles/globals.css';\nRouter.events.on(\"routeChangeStart\", url => {\n  showLoad(url);\n});\nRouter.events.on(\"routeChangeComplete\", () => {\n  hideLoad();\n});\nRouter.events.on(\"routeChangeError\", () => {\n  hideLoad();\n});\nexport default class MyApp extends App {\n  componentDidMount() {\n    let comment = document.createComment(`\n\n=========================================================\n* * NextJS Material Dashboard v1.1.0 based on Material Dashboard React v1.9.0\n=========================================================\n\n* Product Page: https://www.creative-tim.com/product/nextjs-material-dashboard\n* Copyright 2021 Creative Tim (https://www.creative-tim.com)\n* Licensed under MIT (https://github.com/creativetimofficial/nextjs-material-dashboard/blob/master/LICENSE.md)\n\n* Coded by Creative Tim\n\n=========================================================\n\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\n`);\n    document.insertBefore(comment, document.documentElement);\n  } // GetInitialProps corre tanto en server al principio, como en cliente al cambiar de pagina. \n  // La logica requerida solo es requerida al correr del server al principio, por tanto no valido que corra desde el cliente.\n\n\n  static async getInitialProps({\n    Component,\n    router,\n    ctx\n  }) {\n    var _cookies$loginTries;\n\n    let pageProps = {};\n    let {\n      consultorioId\n    } = router.query;\n    const cookies = nookies.get(ctx); // Setear o pedir id de consultorio\n\n    if (consultorioId) {\n      // Set\n      nookies.set(ctx, 'consultorioId', consultorioId, {\n        maxAge: 50 * 365 * 24 * 60 * 60,\n        path: '/'\n      });\n    } else {\n      consultorioId = cookies.consultorioId;\n    } // Redirigir de admin si el usuario no esta logueado\n\n\n    if (cookies.id === undefined && router.asPath.includes(\"admin\") && false) {\n      ctx.res.writeHead(302, {\n        Location: '/login/' + consultorioId,\n        'Content-Type': 'text/html; charset=utf-8'\n      });\n      ctx.res.end();\n    } // Setear si existe, el usuario que ya esta logueado\n\n\n    let initUser;\n\n    if (cookies.id !== undefined && Number((_cookies$loginTries = cookies.loginTries) !== null && _cookies$loginTries !== void 0 ? _cookies$loginTries : 0) <= 2 && false && !router.asPath.includes(\"server-error\")) {\n      try {\n        const {\n          id,\n          token\n        } = {\n          id: cookies.id,\n          token: await GLOBAL_GET_TOKEN(ctx)\n        };\n        console.log({\n          id,\n          consultorioId,\n          token\n        });\n        let patientResponse = await getPatient(id, consultorioId, token);\n        console.log({\n          patientResponse\n        });\n\n        if (!patientResponse.success) {\n          throw Error(\"\");\n        }\n\n        initUser = patientResponse.data;\n\n        if (!router.asPath.includes(\"admin\") && !router.asPath.includes(\"testing\")) {\n          ctx.res.writeHead(302, {\n            Location: '/admin/' + consultorioId + \"/dashboard\",\n            'Content-Type': 'text/html; charset=utf-8'\n          });\n          ctx.res.end(); // ctx.res.finished = true;\n        }\n      } catch (error) {\n        var _cookies$loginTries2;\n\n        nookies.set(ctx, 'loginTries', Number((_cookies$loginTries2 = cookies.loginTries) !== null && _cookies$loginTries2 !== void 0 ? _cookies$loginTries2 : 0) + 1, {\n          maxAge: 60,\n          path: '/'\n        });\n\n        if (Number(cookies.loginTries) === 2) {\n          nookies.destroy(ctx, \"id\", {\n            path: \"/\"\n          });\n          nookies.destroy(ctx, \"dni\", {\n            path: \"/\"\n          });\n          nookies.destroy(ctx, \"loginTries\", {\n            path: \"/\"\n          });\n        }\n\n        ctx.res.writeHead(302, {\n          Location: '/login/' + consultorioId + \"/server-error\",\n          'Content-Type': 'text/html; charset=utf-8'\n        });\n        ctx.res.end(); // ctx.res.finished = true;\n      }\n    }\n\n    if (Component.getInitialProps) {\n      pageProps = await Component.getInitialProps(ctx);\n    }\n\n    return {\n      pageProps,\n      consultorioId,\n      initUser\n    };\n  }\n\n  render() {\n    const {\n      Component,\n      pageProps,\n      consultorioId,\n      initUser\n    } = this.props;\n\n    const Layout = Component.layout || (({\n      children\n    }) => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: children\n    }, void 0, false));\n\n    return /*#__PURE__*/_jsxDEV(ThemeContextProvider, {\n      theme: THEMES[consultorioId - 1],\n      children: /*#__PURE__*/_jsxDEV(UserContextProvider, {\n        initUser: _objectSpread(_objectSpread({}, initUser), {}, {\n          consultorioId\n        }),\n        children: /*#__PURE__*/_jsxDEV(React.Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(Head, {\n            children: [/*#__PURE__*/_jsxDEV(\"meta\", {\n              name: \"viewport\",\n              content: \"width=device-width, initial-scale=1, shrink-to-fit=no\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"title\", {\n              children: \"NextJS Material Dashboard by Creative Tim\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"script\", {\n              src: \"https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Layout, {\n            children: /*#__PURE__*/_jsxDEV(MessageDialogContextProvider, {\n              children: /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }, this);\n  }\n\n}","map":{"version":3,"sources":["C:/DATOS/THISYS/SISTEMA/PORTAL WEB/Proyecto-Salud/pages/_app.js"],"names":["React","ReactDOM","App","Head","Router","PageChange","ThemeContextProvider","THEMES","UserContextProvider","nookies","hideLoad","showLoad","getPatient","GLOBAL_GET_TOKEN","MessageDialog","MessageDialogContextProvider","events","on","url","MyApp","componentDidMount","comment","document","createComment","insertBefore","documentElement","getInitialProps","Component","router","ctx","pageProps","consultorioId","query","cookies","get","set","maxAge","path","id","undefined","asPath","includes","res","writeHead","Location","end","initUser","Number","loginTries","token","console","log","patientResponse","success","Error","data","error","destroy","render","props","Layout","layout","children"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,OAAOC,GAAP,MAAgB,UAAhB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AAEA,OAAOC,UAAP,MAAuB,qCAAvB;AAEA,OAAO,kDAAP;AACA,OAAOC,oBAAP,MAAiC,iCAAjC;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,mBAAP,MAAgC,gCAAhC;AAEA,OAAOC,OAAP,MAAoB,SAApB;AACA,SAASC,QAAT,EAAmBC,QAAnB,QAAmC,kBAAnC;AACA,SAASC,UAAT,QAA2B,sBAA3B;AACA,OAAOC,gBAAP,MAA6B,gBAA7B;AACA,OAAOC,aAAP,MAA0B,qCAA1B;AACA,OAAOC,4BAAP,MAAyC,yCAAzC;AAEA,OAAO,uBAAP;AAEAX,MAAM,CAACY,MAAP,CAAcC,EAAd,CAAiB,kBAAjB,EAAsCC,GAAD,IAAS;AAC5CP,EAAAA,QAAQ,CAACO,GAAD,CAAR;AACD,CAFD;AAGAd,MAAM,CAACY,MAAP,CAAcC,EAAd,CAAiB,qBAAjB,EAAwC,MAAM;AAC5CP,EAAAA,QAAQ;AACT,CAFD;AAGAN,MAAM,CAACY,MAAP,CAAcC,EAAd,CAAiB,kBAAjB,EAAqC,MAAM;AACzCP,EAAAA,QAAQ;AACT,CAFD;AAIA,eAAe,MAAMS,KAAN,SAAoBjB,GAApB,CAAwB;AACrCkB,EAAAA,iBAAiB,GAAG;AAClB,QAAIC,OAAO,GAAGC,QAAQ,CAACC,aAAT,CAAwB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAhBkB,CAAd;AAiBAD,IAAAA,QAAQ,CAACE,YAAT,CAAsBH,OAAtB,EAA+BC,QAAQ,CAACG,eAAxC;AACD,GApBoC,CAqBrC;AACA;;;AACA,eAAaC,eAAb,CAA6B;AAAEC,IAAAA,SAAF;AAAaC,IAAAA,MAAb;AAAqBC,IAAAA;AAArB,GAA7B,EAAyD;AAAA;;AACvD,QAAIC,SAAS,GAAG,EAAhB;AAEA,QAAI;AAAEC,MAAAA;AAAF,QAAoBH,MAAM,CAACI,KAA/B;AAEA,UAAMC,OAAO,GAAGxB,OAAO,CAACyB,GAAR,CAAYL,GAAZ,CAAhB,CALuD,CAOvD;;AACA,QAAIE,aAAJ,EAAmB;AACjB;AACAtB,MAAAA,OAAO,CAAC0B,GAAR,CAAYN,GAAZ,EAAiB,eAAjB,EAAkCE,aAAlC,EAAiD;AAC/CK,QAAAA,MAAM,EAAE,KAAK,GAAL,GAAW,EAAX,GAAgB,EAAhB,GAAqB,EADkB;AAE/CC,QAAAA,IAAI,EAAE;AAFyC,OAAjD;AAID,KAND,MAOK;AACHN,MAAAA,aAAa,GAAGE,OAAO,CAACF,aAAxB;AACD,KAjBsD,CAmBvD;;;AACA,QAAIE,OAAO,CAACK,EAAR,KAAeC,SAAf,IAA4BX,MAAM,CAACY,MAAP,CAAcC,QAAd,CAAuB,OAAvB,CAA5B,SAAJ,EAAkG;AAChGZ,MAAAA,GAAG,CAACa,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AACrBC,QAAAA,QAAQ,EAAE,YAAYb,aADD;AAErB,wBAAgB;AAFK,OAAvB;AAIAF,MAAAA,GAAG,CAACa,GAAJ,CAAQG,GAAR;AACD,KA1BsD,CA4BvD;;;AACA,QAAIC,QAAJ;;AACA,QAAIb,OAAO,CAACK,EAAR,KAAeC,SAAf,IAA4BQ,MAAM,wBAACd,OAAO,CAACe,UAAT,qEAAuB,CAAvB,CAAN,IAAmC,CAA/D,aAAqG,CAACpB,MAAM,CAACY,MAAP,CAAcC,QAAd,CAAuB,cAAvB,CAA1G,EAAkJ;AAChJ,UAAI;AACF,cAAM;AAAEH,UAAAA,EAAF;AAAMW,UAAAA;AAAN,YAAgB;AAAEX,UAAAA,EAAE,EAAEL,OAAO,CAACK,EAAd;AAAkBW,UAAAA,KAAK,EAAE,MAAMpC,gBAAgB,CAACgB,GAAD;AAA/C,SAAtB;AAEAqB,QAAAA,OAAO,CAACC,GAAR,CAAY;AAAEb,UAAAA,EAAF;AAAMP,UAAAA,aAAN;AAAqBkB,UAAAA;AAArB,SAAZ;AAEA,YAAIG,eAAe,GAAG,MAAMxC,UAAU,CAAC0B,EAAD,EAAKP,aAAL,EAAoBkB,KAApB,CAAtC;AAEAC,QAAAA,OAAO,CAACC,GAAR,CAAY;AAAEC,UAAAA;AAAF,SAAZ;;AAEA,YAAI,CAACA,eAAe,CAACC,OAArB,EAA8B;AAC5B,gBAAMC,KAAK,CAAC,EAAD,CAAX;AACD;;AAEDR,QAAAA,QAAQ,GAAGM,eAAe,CAACG,IAA3B;;AAEA,YAAI,CAAC3B,MAAM,CAACY,MAAP,CAAcC,QAAd,CAAuB,OAAvB,CAAD,IAAoC,CAACb,MAAM,CAACY,MAAP,CAAcC,QAAd,CAAuB,SAAvB,CAAzC,EAA4E;AAC1EZ,UAAAA,GAAG,CAACa,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AACrBC,YAAAA,QAAQ,EAAE,YAAYb,aAAZ,GAA4B,YADjB;AAErB,4BAAgB;AAFK,WAAvB;AAIAF,UAAAA,GAAG,CAACa,GAAJ,CAAQG,GAAR,GAL0E,CAM1E;AACD;AACF,OAvBD,CAuBE,OAAOW,KAAP,EAAc;AAAA;;AACd/C,QAAAA,OAAO,CAAC0B,GAAR,CAAYN,GAAZ,EAAiB,YAAjB,EAAgCkB,MAAM,yBAACd,OAAO,CAACe,UAAT,uEAAuB,CAAvB,CAAP,GAAoC,CAAnE,EAAsE;AACpEZ,UAAAA,MAAM,EAAE,EAD4D;AAEpEC,UAAAA,IAAI,EAAE;AAF8D,SAAtE;;AAIA,YAAIU,MAAM,CAACd,OAAO,CAACe,UAAT,CAAN,KAA+B,CAAnC,EAAsC;AACpCvC,UAAAA,OAAO,CAACgD,OAAR,CAAgB5B,GAAhB,EAAqB,IAArB,EAA2B;AACzBQ,YAAAA,IAAI,EAAE;AADmB,WAA3B;AAGA5B,UAAAA,OAAO,CAACgD,OAAR,CAAgB5B,GAAhB,EAAqB,KAArB,EAA4B;AAC1BQ,YAAAA,IAAI,EAAE;AADoB,WAA5B;AAGA5B,UAAAA,OAAO,CAACgD,OAAR,CAAgB5B,GAAhB,EAAqB,YAArB,EAAmC;AACjCQ,YAAAA,IAAI,EAAE;AAD2B,WAAnC;AAGD;;AAEDR,QAAAA,GAAG,CAACa,GAAJ,CAAQC,SAAR,CAAkB,GAAlB,EAAuB;AACrBC,UAAAA,QAAQ,EAAE,YAAYb,aAAZ,GAA4B,eADjB;AAErB,0BAAgB;AAFK,SAAvB;AAIAF,QAAAA,GAAG,CAACa,GAAJ,CAAQG,GAAR,GArBc,CAsBd;AAID;AACF;;AAED,QAAIlB,SAAS,CAACD,eAAd,EAA+B;AAC7BI,MAAAA,SAAS,GAAG,MAAMH,SAAS,CAACD,eAAV,CAA0BG,GAA1B,CAAlB;AACD;;AAED,WAAO;AAAEC,MAAAA,SAAF;AAAaC,MAAAA,aAAb;AAA4Be,MAAAA;AAA5B,KAAP;AACD;;AACDY,EAAAA,MAAM,GAAG;AACP,UAAM;AAAE/B,MAAAA,SAAF;AAAaG,MAAAA,SAAb;AAAwBC,MAAAA,aAAxB;AAAuCe,MAAAA;AAAvC,QAAoD,KAAKa,KAA/D;;AAEA,UAAMC,MAAM,GAAGjC,SAAS,CAACkC,MAAV,KAAqB,CAAC;AAAEC,MAAAA;AAAF,KAAD,kBAAkB;AAAA,gBAAGA;AAAH,qBAAvC,CAAf;;AAEA,wBACE,QAAC,oBAAD;AAAsB,MAAA,KAAK,EAAEvD,MAAM,CAACwB,aAAa,GAAG,CAAjB,CAAnC;AAAA,6BACE,QAAC,mBAAD;AAAqB,QAAA,QAAQ,kCAAOe,QAAP;AAAiBf,UAAAA;AAAjB,UAA7B;AAAA,+BACE,QAAC,KAAD,CAAO,QAAP;AAAA,kCACE,QAAC,IAAD;AAAA,oCACE;AACE,cAAA,IAAI,EAAC,UADP;AAEE,cAAA,OAAO,EAAC;AAFV;AAAA;AAAA;AAAA;AAAA,oBADF,eAKE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBALF,eAME;AAAQ,cAAA,GAAG,EAAC;AAAZ;AAAA;AAAA;AAAA;AAAA,oBANF;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,eASE,QAAC,MAAD;AAAA,mCACE,QAAC,4BAAD;AAAA,qCACE,QAAC,SAAD,oBAAeD,SAAf;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,kBATF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF;AAqBD;;AA1IoC","sourcesContent":["/*!\r\n\r\n=========================================================\r\n* NextJS Material Dashboard v1.1.0 based on Material Dashboard React v1.9.0\r\n=========================================================\r\n\r\n* Product Page: https://www.creative-tim.com/product/nextjs-material-dashboard\r\n* Copyright 2021 Creative Tim (https://www.creative-tim.com)\r\n* Licensed under MIT (https://github.com/creativetimofficial/nextjs-material-dashboard/blob/master/LICENSE.md)\r\n\r\n* Coded by Creative Tim\r\n\r\n=========================================================\r\n\r\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\n*/\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"next/app\";\r\nimport Head from \"next/head\";\r\nimport Router from \"next/router\";\r\n\r\nimport PageChange from \"components/PageChange/PageChange.js\";\r\n\r\nimport \"assets/css/nextjs-material-dashboard.css?v=1.1.0\";\r\nimport ThemeContextProvider from \"../context/ThemeContextProvider\";\r\nimport THEMES from \"../constants/THEMES\";\r\nimport UserContextProvider from \"../context/UserContextProvider\";\r\n\r\nimport nookies from 'nookies'\r\nimport { hideLoad, showLoad } from \"../utils/loading\";\r\nimport { getPatient } from \"../services/userAuth\";\r\nimport GLOBAL_GET_TOKEN from \"../utils/token\";\r\nimport MessageDialog from \"../components/Dialogs/MessageDialog\";\r\nimport MessageDialogContextProvider from \"../context/MessageDialogContextProvider\";\r\n\r\nimport '../styles/globals.css';\r\n\r\nRouter.events.on(\"routeChangeStart\", (url) => {\r\n  showLoad(url);\r\n});\r\nRouter.events.on(\"routeChangeComplete\", () => {\r\n  hideLoad();\r\n});\r\nRouter.events.on(\"routeChangeError\", () => {\r\n  hideLoad();\r\n});\r\n\r\nexport default class MyApp extends App {\r\n  componentDidMount() {\r\n    let comment = document.createComment(`\r\n\r\n=========================================================\r\n* * NextJS Material Dashboard v1.1.0 based on Material Dashboard React v1.9.0\r\n=========================================================\r\n\r\n* Product Page: https://www.creative-tim.com/product/nextjs-material-dashboard\r\n* Copyright 2021 Creative Tim (https://www.creative-tim.com)\r\n* Licensed under MIT (https://github.com/creativetimofficial/nextjs-material-dashboard/blob/master/LICENSE.md)\r\n\r\n* Coded by Creative Tim\r\n\r\n=========================================================\r\n\r\n* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\n`);\r\n    document.insertBefore(comment, document.documentElement);\r\n  }\r\n  // GetInitialProps corre tanto en server al principio, como en cliente al cambiar de pagina. \r\n  // La logica requerida solo es requerida al correr del server al principio, por tanto no valido que corra desde el cliente.\r\n  static async getInitialProps({ Component, router, ctx }) {\r\n    let pageProps = {};\r\n\r\n    let { consultorioId } = router.query;\r\n\r\n    const cookies = nookies.get(ctx)\r\n\r\n    // Setear o pedir id de consultorio\r\n    if (consultorioId) {\r\n      // Set\r\n      nookies.set(ctx, 'consultorioId', consultorioId, {\r\n        maxAge: 50 * 365 * 24 * 60 * 60,\r\n        path: '/',\r\n      })\r\n    }\r\n    else {\r\n      consultorioId = cookies.consultorioId;\r\n    }\r\n\r\n    // Redirigir de admin si el usuario no esta logueado\r\n    if (cookies.id === undefined && router.asPath.includes(\"admin\") && typeof window === 'undefined') {\r\n      ctx.res.writeHead(302, {\r\n        Location: '/login/' + consultorioId,\r\n        'Content-Type': 'text/html; charset=utf-8',\r\n      });\r\n      ctx.res.end();\r\n    }\r\n\r\n    // Setear si existe, el usuario que ya esta logueado\r\n    let initUser;\r\n    if (cookies.id !== undefined && Number(cookies.loginTries ?? 0) <= 2 && typeof window === 'undefined' && !router.asPath.includes(\"server-error\")) {\r\n      try {\r\n        const { id, token } = { id: cookies.id, token: await GLOBAL_GET_TOKEN(ctx) };\r\n\r\n        console.log({ id, consultorioId, token });\r\n\r\n        let patientResponse = await getPatient(id, consultorioId, token);\r\n\r\n        console.log({ patientResponse });\r\n\r\n        if (!patientResponse.success) {\r\n          throw Error(\"\");\r\n        }\r\n\r\n        initUser = patientResponse.data;\r\n\r\n        if (!router.asPath.includes(\"admin\") && !router.asPath.includes(\"testing\")) {\r\n          ctx.res.writeHead(302, {\r\n            Location: '/admin/' + consultorioId + \"/dashboard\",\r\n            'Content-Type': 'text/html; charset=utf-8',\r\n          });\r\n          ctx.res.end();\r\n          // ctx.res.finished = true;\r\n        }\r\n      } catch (error) {\r\n        nookies.set(ctx, 'loginTries', (Number(cookies.loginTries ?? 0)) + 1, {\r\n          maxAge: 60,\r\n          path: '/',\r\n        })\r\n        if (Number(cookies.loginTries) === 2) {\r\n          nookies.destroy(ctx, \"id\", {\r\n            path: \"/\"\r\n          });\r\n          nookies.destroy(ctx, \"dni\", {\r\n            path: \"/\"\r\n          });\r\n          nookies.destroy(ctx, \"loginTries\", {\r\n            path: \"/\"\r\n          });\r\n        }\r\n\r\n        ctx.res.writeHead(302, {\r\n          Location: '/login/' + consultorioId + \"/server-error\",\r\n          'Content-Type': 'text/html; charset=utf-8',\r\n        });\r\n        ctx.res.end();\r\n        // ctx.res.finished = true;\r\n\r\n\r\n\r\n      }\r\n    }\r\n\r\n    if (Component.getInitialProps) {\r\n      pageProps = await Component.getInitialProps(ctx);\r\n    }\r\n\r\n    return { pageProps, consultorioId, initUser };\r\n  }\r\n  render() {\r\n    const { Component, pageProps, consultorioId, initUser } = this.props;\r\n\r\n    const Layout = Component.layout || (({ children }) => <>{children}</>);\r\n\r\n    return (\r\n      <ThemeContextProvider theme={THEMES[consultorioId - 1]}>\r\n        <UserContextProvider initUser={{ ...initUser, consultorioId }}>\r\n          <React.Fragment>\r\n            <Head>\r\n              <meta\r\n                name=\"viewport\"\r\n                content=\"width=device-width, initial-scale=1, shrink-to-fit=no\"\r\n              />\r\n              <title>NextJS Material Dashboard by Creative Tim</title>\r\n              <script src=\"https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE\"></script>\r\n            </Head>\r\n            <Layout>\r\n              <MessageDialogContextProvider>\r\n                <Component {...pageProps} />\r\n              </MessageDialogContextProvider>\r\n            </Layout>\r\n          </React.Fragment>\r\n        </UserContextProvider>\r\n      </ThemeContextProvider>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}