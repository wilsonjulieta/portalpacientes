{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext, useEffect, useState } from \"react\"; // @material-ui/core components\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport InputLabel from \"@material-ui/core/InputLabel\"; // layout for this page\n\nimport Admin from \"layouts/Admin.js\"; // core components\n\nimport GridItem from \"components/Grid/GridItem.js\";\nimport GridContainer from \"components/Grid/GridContainer.js\";\nimport CustomInput from \"components/CustomInput/CustomInput.js\";\nimport Button from \"components/CustomButtons/Button.js\";\nimport Card from \"components/Card/Card.js\";\nimport CardHeader from \"components/Card/CardHeader.js\";\nimport CardAvatar from \"components/Card/CardAvatar.js\";\nimport CardBody from \"components/Card/CardBody.js\";\nimport CardFooter from \"components/Card/CardFooter.js\";\nimport avatar from \"assets/img/faces/marc.jpg\";\nimport Login from \"../../layouts/Login\";\nimport { FormControl, FormGroup, MenuItem, NativeSelect, Select, TextField } from \"@material-ui/core\";\nimport styles from \"assets/jss/nextjs-material-dashboard/layouts/loginStyle.js\";\nimport { ThemeContext } from \"../../context/ThemeContextProvider\";\nimport { useRouter } from \"next/router\";\nimport THEMES from \"../../constants/THEMES\";\nimport { logIn } from \"../../services/userAuth.js\";\nimport { UserContext } from \"../../context/UserContextProvider\";\nimport useTheme from \"../../hooks/useTheme\";\nimport CustomPasswordInput from \"../../components/CustomInput/CustomPasswordInput\";\nimport { setCookie } from \"nookies\";\nimport { hideLoad, showLoad } from \"../../utils/loading\";\n\nfunction LoginView(_ref) {\n  var consultorioId = _ref.consultorioId;\n  var router = useRouter();\n  var path = \"Inicio\";\n  var classes = useTheme(styles);\n\n  var _useState = useState(\"\"),\n      errorMsg = _useState[0],\n      setErrorMsg = _useState[1];\n\n  var _useContext = useContext(UserContext),\n      setUser = _useContext.setUser;\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n      var formData, tipoDoc, username, password, loginResponse;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              formData = new FormData(event.target);\n              tipoDoc = formData.get(\"tipodoc\");\n              username = formData.get(\"username\");\n              password = formData.get(\"password\");\n              showLoad(path);\n              loginResponse = {};\n              _context.prev = 7;\n              _context.next = 10;\n              return logIn(tipoDoc, username, password, consultorioId);\n\n            case 10:\n              loginResponse = _context.sent;\n              _context.next = 15;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](7);\n\n            case 15:\n              _context.prev = 15;\n              return _context.finish(15);\n\n            case 17:\n              console.log(loginResponse); // loginResponse = {message: \"Sus datos estÃ¡n cargados pero no se encuentra registrado. Ingrese a \\\"registrarse\\\".\"}\n\n              if (!loginResponse.loggedIn) {\n                _context.next = 28;\n                break;\n              }\n\n              sessionStorage.setItem(\"id\", loginResponse.data.id);\n              sessionStorage.setItem(\"token\", loginResponse.token);\n              setCookie(null, 'id', loginResponse.data.id, {\n                maxAge: 50 * 365 * 24 * 60 * 60,\n                path: '/'\n              });\n              setCookie(null, 'token', loginResponse.token, {\n                maxAge: 24 * 60 * 60,\n                path: '/'\n              });\n              setUser(_objectSpread(_objectSpread({}, loginResponse.data), {}, {\n                consultorioId: consultorioId\n              }));\n              router.push(\"/admin/\" + consultorioId + \"/dashboard\");\n              return _context.abrupt(\"return\", true);\n\n            case 28:\n              sessionStorage.clear();\n              hideLoad(path);\n              setErrorMsg(loginResponse.message);\n              return _context.abrupt(\"return\", false);\n\n            case 32:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[7, 13, 15, 17]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleRegisterRedirect = function handleRegisterRedirect() {\n    var currentPath = router.asPath; // get the current URL path\n\n    router.push(currentPath + \"/register\");\n  };\n\n  return /*#__PURE__*/_jsx(\"form\", {\n    method: \"post\",\n    action: \"/admin/dashboard\",\n    onSubmit: handleSubmit,\n    autoComplete: \"on\",\n    children: /*#__PURE__*/_jsx(GridContainer, {\n      style: {\n        width: \"100%\",\n        height: \"80vh\",\n        alignItems: \"center\"\n      },\n      justify: \"center\",\n      children: /*#__PURE__*/_jsx(GridItem, {\n        xs: 12,\n        sm: 10,\n        md: 7,\n        children: /*#__PURE__*/_jsxs(Card, {\n          children: [/*#__PURE__*/_jsxs(CardHeader, {\n            color: \"primary\",\n            children: [/*#__PURE__*/_jsx(\"h4\", {\n              className: classes.cardTitleWhite,\n              children: \"Bienvenido\"\n            }), /*#__PURE__*/_jsx(\"p\", {\n              className: classes.cardCategoryWhite,\n              children: \"Complete sus datos de ingreso\"\n            })]\n          }), /*#__PURE__*/_jsx(CardBody, {\n            children: /*#__PURE__*/_jsxs(GridContainer, {\n              children: [/*#__PURE__*/_jsx(GridItem, {\n                xs: 12,\n                sm: 12,\n                md: 12,\n                children: /*#__PURE__*/_jsxs(FormControl, {\n                  fullWidth: true,\n                  children: [/*#__PURE__*/_jsx(InputLabel, {\n                    className: classes.label,\n                    variant: \"standard\",\n                    htmlFor: \"uncontrolled-native\",\n                    children: \"Tipo de Documento\"\n                  }), /*#__PURE__*/_jsxs(Select, {\n                    className: classes.select,\n                    classes: {\n                      root: classes.selectRoot\n                    },\n                    defaultValue: 1,\n                    inputProps: {\n                      name: 'tipodoc',\n                      id: 'uncontrolled-native',\n                      required: true,\n                      onChange: function onChange() {\n                        return setErrorMsg(false);\n                      }\n                    },\n                    children: [/*#__PURE__*/_jsx(MenuItem, {\n                      value: 1,\n                      selected: true,\n                      children: \"DNI\"\n                    }), /*#__PURE__*/_jsx(MenuItem, {\n                      value: 2,\n                      children: \"CI\"\n                    }), /*#__PURE__*/_jsx(MenuItem, {\n                      value: 3,\n                      children: \"Pasaporte\"\n                    })]\n                  })]\n                })\n              }), /*#__PURE__*/_jsx(GridItem, {\n                xs: 12,\n                sm: 12,\n                md: 12,\n                children: /*#__PURE__*/_jsx(CustomInput, {\n                  labelText: \"Nro. de Documento\",\n                  id: \"username\",\n                  formControlProps: {\n                    fullWidth: true\n                  },\n                  inputProps: {\n                    name: 'username',\n                    id: \"username\",\n                    type: \"number\",\n                    required: true,\n                    autoComplete: \"username\",\n                    onChange: function onChange() {\n                      return setErrorMsg(false);\n                    }\n                  }\n                })\n              }), /*#__PURE__*/_jsx(GridItem, {\n                xs: 12,\n                sm: 12,\n                md: 12,\n                children: /*#__PURE__*/_jsx(CustomPasswordInput, {\n                  labelText: \"Contrase\\xF1a\",\n                  inputName: \"password\",\n                  handleChangeHook: function handleChangeHook() {\n                    return setErrorMsg(false);\n                  }\n                })\n              }), /*#__PURE__*/_jsx(GridItem, {\n                children: /*#__PURE__*/_jsx(\"p\", {\n                  style: {\n                    color: errorMsg ? \"red\" : \"transparent\",\n                    margin: \"0\",\n                    transition: \"all 0.6s\",\n                    userSelect: \"none\"\n                  },\n                  children: errorMsg ? errorMsg : \"Sus datos estan cargados pero no se encuentra registrado. Ingrese a \\\"registrarse\\\".\"\n                })\n              })]\n            })\n          }), /*#__PURE__*/_jsxs(CardFooter, {\n            style: {\n              paddingTop: \"0\",\n              flexWrap: \"wrap\",\n              rowGap: \"10px\",\n              justifyContent: \"center\",\n              paddingInline: \"18px\"\n            },\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              style: {\n                flex: \"1 0 33.33%\",\n                textAlign: \"left\"\n              },\n              className: \"botonLoginRegistro\",\n              children: /*#__PURE__*/_jsx(Button, {\n                onClick: handleRegisterRedirect,\n                type: \"button\",\n                color: \"primaryOutlined\",\n                style: {\n                  padding: \"15px 6px\"\n                },\n                children: \"Registrarse\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                flex: \"1 0 33.33%\",\n                textAlign: \"center\"\n              },\n              className: \"botonLoginIngreso\",\n              children: /*#__PURE__*/_jsx(Button, {\n                type: \"submit\",\n                color: \"primary\",\n                style: {\n                  fontSize: \"1.35em\"\n                },\n                children: \"Ingresar\"\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              style: {\n                flex: \"1 0 33.33%\",\n                textAlign: \"right\"\n              },\n              className: \"botonLoginOlvido\",\n              children: /*#__PURE__*/_jsx(Button, {\n                type: \"button\",\n                color: \"secondarySimple\",\n                style: {\n                  padding: \"15px 6px\"\n                },\n                children: \"Olvid\\xE9 mi contrase\\xF1a\"\n              })\n            })]\n          })]\n        })\n      })\n    })\n  });\n}\n\nLoginView.layout = Login;\nexport var __N_SSP = true;\nexport default LoginView;","map":null,"metadata":{},"sourceType":"module"}